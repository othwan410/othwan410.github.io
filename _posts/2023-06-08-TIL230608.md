---
layout: single
title:  "퀵 정렬"
---
  
# 퀵 정렬

오늘 공부해본 알고리즘은 퀵정렬이다.  
퀵정렬의 특징은 평균 실행 속도가 아주 우수한 정렬이다.  
리스트를 두 개의 부분리스트로 분할을 하는데 여기서 특징은 비균등 분할이다.  
왜 비균등 분할일까? 그 이유는 퀵 정렬의 알고리즘에 있다.

```
function quick_sort(left, right) {
  let pivot, i, j, temp;

  if (left < right) {
    i = left;
    j = right + 1;
    pivot = arr[left];

    do {
      do i++;
      while (arr[i] < pivot);
      do j--;
      while (arr[j] > pivot);

      if (i < j) SWAP(i, j);
      console.log(arr);
    } while (i < j);

    SWAP(left, j);
    quick_sort(left, j - 1);
    quick_sort(j + 1, right);
  }
}
```

위 코드가 내가 작성한 퀵정렬의 코드이다.  
이 코드를 보면 pivot을 설정해 준다. 그리고 그 pivot은 각 분할 리스트의 가장 첫 번째 인덱스의 레코드를 갖게 하였다.  
그 후 배열의 왼쪽부터 pivot보다 큰 레코드를 찾는다(i). 그러면서 바로 이번에는 오른쪽부터 pivot보다 작은 레코드를 찾는다.(j)  
그리고 발견한 두 자리의 레코드를 바꿔주고 그 자리에서 다시 탐색을 하여 반복을 하는데, 만약 발견을 했을 때 두 지점이 서로를 지나쳤다면 바꾸지 않고 그 자리에 멈춘다.(i>j)  
이제 j가 가리키고 있던 자리를 피벗과 바꾸어 준다. 그럼 pivot을 앞으로는 pivot보다 작은 레코드만, 뒤로는 pivot보다 큰 레코드만 위치하게 된다.  
그리고 이제 pivot을 기준으로 앞의 배열을 다시 퀵정렬을 실행하고, 뒤의 배열도 퀵정렬을 실행한다. 그리고 이 행동은 right가 left보다 작아졌을 때까지 반복한다.   
여기서 비균등 분할인 이유가 나온다. 당연히 첫 번째 위치한 값이 정확한 중간값이면 균등하겠지만, 그렇지 않다면 pivot이 탐색이 끝났을 때 그 자리에 그대로 위치하거나 제일 뒤에도 위치할 수 있다.  
그렇기 때문에 비균등 분할이 된다.  
  
퀵 정렬의 평균 복잡도는 nlog(n)이라고 한다.  
분할리스트가 생성되어 퀵정렬을 실행하기 전에 퀵정렬 알고리즘을 한 번 도는 것을 하나의 패스라고할 때  
패스의 수는 log(n)이 된다. 그 이유는 분할리스트는 두 개의 리스트로만 나누어지기 때문이다.  
그리고 각 패스 안에서의 비교횟수는 n번이 된다.  
그렇기에 총 비교횟수는 nlog(n)이 된다.  

하지만 최악의 경우에는 n^2이 된다.  
극도로 불균등한 리스트에서는 패스의 수가 n이된다. 그 이유는 퀵 정렬은 비균등 분할을 하기 때문이다.  
예를들어 pivot이 계속해서 가장 작은수와, 가장 큰수 이런식으로 결정될 때 이다.  
그리고 각 패스에서의 비교횟수는 n번이다.  
그렇기 때문에 총 비교횟는 n^2이 된다.  

그렇다면 최악의 경우를 피하는게 퀵정렬의 성능을 향상시킬 수 있는 방법이 될 것이다.  
그렇게 하기 위해서는 리스트의 중앙에 가까운 pivot값을 정하는 게 좋다.  
하지만 정확한 중간 값을 갖는다는 것은 정렬을 해야하기에 모순이 될 수 있다.  
그렇다면 3개 혹은 5,7개의 레코드 중에서 중간 값을 pivot값으로 설정한다면 가장 중앙에 가까운 pivot값을 설정하기 쉬울 수 있다.  

그리고 더 향상시키기 위해서 특정 시점에 삽입정렬로 전환하는 것이다.  
삽입정렬은 알고리즘이 단순해 리스트 내에 존재하는 레코드의 수가 적을 때 유리할 수 있다.  
그리고 퀵정렬은 리스트 내의 레코드 수가 적을 때에도 상당히 많은 재귀호출을 수행해야 하기 때문에 두 정렬을 적절히 조합한다면 더욱 성능을 향상시킬 수 있다.  
그리고 찾아보니 javascript에서 sort 또한 이와 같은 방법을 사용한다고 한다.  


