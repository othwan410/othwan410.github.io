---
layout: single
title:  "좋아요의 구현"
---

# 좋아요를 어떻게 구현하면 좋을지

팀 프로젝트로 뉴스피드를 구현해 보면서 좋아요 기능을 넣었었다.  
내가 계획한 테이블은 뉴스 테이블 따로, 좋아요 테이블을 따로 만들었었다.  
좋아요 테이블에는 newsId와 userId를 참조키로 넣어주고 사용했는데, 이렇게 구현한 이유는 좋아요 취소를 구현하기 위해서였다.  
하지만 내가 생각하기엔 이 방법은 단점이 좀 있는 것 같다.  
하나는 count를 해온다는 점이다.  
인덱스를 쓰는 게 맞을지는 모르겠지만 쓴다고 해도 어떤 포스트에 좋아요가 많이 달릴지 모르기에 적절한 인덱스 설정이 어렵다고 느껴지고,  
내가 생각한 다른 문제는 테이블의 row가 너무 많아졌을 때 newsId와 userId가 일치하는 값 하나만 select를 할 때, 시간이 오래 걸릴 거 같다는 것이다.  

# 내 생각

위의 문제점을 해결하기 위해 내가 생각한 것은 뉴스 테이블에 count한 값을 넣어주는 것이다.  
유저가 좋아요를 눌렀을 때 count라는 칼럼은 1을 더해주면 된다.  
취소일 경우에도 1만 빼주면 된다.  
이러면 count해주는 연산을 하지않고 뉴스 테이블을 조회했을 때 count값을 바로 얻을 수 있을 것 같다.  
하지만 이러면 뉴스 테이블의 좋아요 수와 좋아요 테이블의 수가 일치하지 않는 오류가 발생할 수 있다.  
검증이 필요하겠지만, 트랜잭션을 활용하면 되지 않을까 싶다.  
row가 많아지는 문제점은 어떻게 해결해야 할지 모르겠다.  
하나의 로우에 데이터를 배열로 길게 쌓는 방법도 옳은거라고 생각되지 않는다.  
이 문제를 해결할 방법을 찾아서 공부해봐야겠다.

